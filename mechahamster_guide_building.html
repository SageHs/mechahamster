<!-- HTML header for doxygen 1.8.6-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>MechaHamster: Building MechaHamster</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="https://fonts.googleapis.com/css?family=Roboto:300,400,400italic,500,500italic,700,700italic|Roboto+Mono:400,700" rel="stylesheet">
<link href="style.css" rel="stylesheet" type="text/css"/>
<script>
  /**
   * Check if the browser rendering this page is being run on an Android device.
   * It checks if the string 'android' is found in the browser's `userAgent`.
   * @return {boolean} This returns `true` if the browser's `userAgent` contains
   * the string 'android' (indicating that the browser is on an Android device).
   * Otherwise, it returns `false`.
   */
  function isAndroidDevice() {
    if (navigator && navigator.userAgent) {
      return navigator.userAgent.toLowerCase().indexOf('android') != -1;
    } else {
      return false;
    }
  }
  /**
   * Check if an HTML `class` attribute is in the browser-specific format.
   * @param {string} An HTML `class` attribute in the format 'browser-{device}'.
   * @return {boolean} Returns `true` if `browserClass` was in the valid format,
   * prefixed with 'browser-'. Otherwise, it returns false.
   */
  function isBrowserSpecificClassName(browserClass) {
    if (browserClass && browserClass.substring(0, 8) == 'browser-' &&
        browserClass.length > 8) {
      return true;
    } else {
      return false;
    }
  }
  /**
   * Get all the HTML Elements with browser-specific `class` attributes.
   * @return {array} Returns an array of all the HTML Elements with a `class`
   * attribute that is prefixed with `browser-`.
   */
  function getAllBrowserSpecificElements() {
    if (document) {
      var htmlElements = document.getElementsByTagName("*");
      var browserSpecificElements = [];
      for (var i = 0; i < htmlElements.length; i++) {
        if (isBrowserSpecificClassName(htmlElements[i].className)) {
          browserSpecificElements.push(htmlElements[i]);
        }
      }
      return browserSpecificElements;
    } else {
      return null;
    }
  }
  /**
   * Given a browser-specific HTML `class` attribute, extract the device name.
   * @param {string} browserClass The string name of an HTML `class` attribute,
   * in the format `browser-{device}`.
   * @return {string} Returns a string containing only the device portion of
   * the class name. If the input was invalid, then it returns `null`.
   */
  function extractDeviceFromBrowserClass(browserClass) {
    if (isBrowserSpecificClassName(browserClass)) {
      return browserClass.substring(8);
    }
    else {
      return null;
    }
  }
  /**
   * Hide device specific elements that do not apply to the current device.
   */
  function handleDeviceSpecificLoading() {
    var browserSpecificElements = getAllBrowserSpecificElements();
    for (var i = 0; i < browserSpecificElements.length; i++) {
      var device = extractDeviceFromBrowserClass(browserSpecificElements[i].className);
      if (device && !isAndroidDevice() && device == 'android') {
        browserSpecificElements[i].innerHTML = '';
      } else if(device && isAndroidDevice() && device == 'desktop') {
        browserSpecificElements[i].innerHTML = '';
      }
    }
  }
  $(document).ready(handleDeviceSpecificLoading);
</script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="commonprojectlogo">
    <img alt="Logo" src="fpl_logo_small.png"/>
  </td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">MechaHamster
   </div>
   <div style="font-size:12px;">
	 An open source project by
     <a href="https://developers.google.com/games/#Tools">FPL</a>.
  </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>MechaHamster</span></a></li>
      <li><a href="mechahamster_guide_gameplay.html"><span>Gameplay</span></a></li>
      <li><a href="mechahamster_guide_overview.html"><span>Programmer's&#160;Guide</span></a></li>
      <li><a href="mechahamster_readme.html"><span>Readme</span></a></li>
      <li><a href="contributing.html"><span>Contributing</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('mechahamster_guide_building.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Building MechaHamster </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h3>Downloading Source Code</h3>
<p>Source code for MechaHamster is available for download from <a href="https://github.com/google/mechahamster">Github.</a></p>
<h3>Overview</h3>
<p>The MechaHamster project was built using version 5.6.06b of the Unity Editor. Opening it with an older version of the editor may encounter errors.</p>
<p>When you first open MechaHamster in Unity, you will see a large number of errors. MechaHamster depends on several external packages that need to be imported before it can be run.</p>
<h3>Firebase Build Setup</h3>
<p>You will need to download the <a href="https://firebase.google.com/docs/unity/setup">Firebase Unity SDK</a>, and import the following packages into the Unity project:</p>
<table class="doxtable">
<tr>
<th>Package </th><th>File Name  </th></tr>
<tr>
<td>Firebase Analytics </td><td>FirebaseAnalytics.unitypackage </td></tr>
<tr>
<td>Firebase Auth </td><td>FirebaseAuth.unitypackage </td></tr>
<tr>
<td>Firebase Database </td><td>FirebaseDatabase.unitypackage </td></tr>
<tr>
<td>Firebase Invites </td><td>FirebaseInvites.unitypackage </td></tr>
<tr>
<td>Firebase Messaging </td><td>FirebaseMessaging.unitypackage </td></tr>
<tr>
<td>Firebase Remote Config </td><td>FirebaseRemoteConfig.unitypackage </td></tr>
</table>
<h3>Downloading Firebase Files</h3>
<p>In addition to importing the Firebase Unity SDK packages you'll also need to create a a project in the <a href="https://console.firebase.google.com/">Firebase Console</a>, and download the files necessary to link it to MechaHamster:</p>
<ol type="1">
<li>Navigate to the <a href="https://console.firebase.google.com/">Firebase Console</a>.</li>
<li>If you already have an existing Google project associated with your mobile app, click <b>Import Google Project.</b> Otherwise, click <b>Create New Project.</b></li>
<li>Select the target platform (Android or iOS) and follow the setup steps. If you're importing an existing Google project, this may happen automatically and you can just download the config file.</li>
<li>When prompted, enter the app's package name. (<code>com.google.fpl.mechahamster</code>)</li>
<li>At the end, depending on your platform, you'll download a file named <code>google-services.json</code> (android) or <code>GoogleService-Info.plist</code> (iOS). Put this file somewhere in your <code>/Assets</code> directory. (You can re-download this file again at any time from the <a href="https://console.firebase.google.com/">Firebase Console</a>.)</li>
</ol>
<h3>Setting Project Properties and Permissions</h3>
<h4>(Android Only) Add your signing key's SHA-1 to the project</h4>
<p>In order to make use of several Firebase features, (Authentication and App Invites) you will need to calculate a SHA-1 hash from your signing key, and enter it into the Firebase console.</p>
<p>Note: This is only necessary when building for Android devices. You do not need to enter the SHA-1 for iOS builds.</p>
<ol type="1">
<li>Navigate to the <a href="https://console.firebase.google.com/">Firebase Console</a>.</li>
<li>In the upper left, click on the gear, and select 'Project Settings'</li>
<li>Enter your signing certificate's SHA-1 in the indicated field. (Instructions for calculating your certificate's fingerprint can be found <a href="https://developers.google.com/android/guides/client-auth">here</a>)</li>
<li>After the change, you need to re-download <code>google-services.json</code> again. You can find the download button in the same page. Then replace the one you stored in your <code>/Assets</code> directory.</li>
</ol>
<h4>(iOS Only) Set App Capabilities</h4>
<p>MechaHamster requires several capabilities to be enabled in XCode in order to function on iOS devices.</p>
<ol type="1">
<li>After doing an iOS build in Unity, open the resulting project in XCode.</li>
<li>Go to the project's settings, click the 'Capabilities' tab.</li>
<li>Enable 'Keychain Sharing'.</li>
<li>Enable 'Push Notifications'.</li>
<li>Enable 'Associated Domains'.</li>
<li>Expand 'Associated Domains' and add "applinks:YOUR_DYNAMIC_LINKS_DOMAIN" to the list. You can find your project's Dynamic Links domain under the Dynamic Links tab of the <a href="https://console.firebase.google.com/">Firebase console</a>.</li>
</ol>
<h4>Enable Login Methods</h4>
<p>Firebase Auth provides several methods by which a user can sign in and access their data. MechaHamster supports several of these, but they must be enabled in the Firebase console before they can be used. (They are all disabled by default.)</p>
<ol type="1">
<li>Navigate to the <a href="https://console.firebase.google.com/">Firebase Console</a>, and select 'Authentication' from the side panel.</li>
<li>Click on the 'Sign-In Method' tab.</li>
<li>Select "Anonymous" from the list, enable it, and click 'Save'.</li>
<li>Select "Email/Password" from the list, enable it, and click 'Save'.</li>
</ol>
<h4>Set up the database access rules</h4>
<p>MechaHamster depends heavily on the Firebase Realtime Database for storage. In order to run Mechahamster, you'll need set up the database access rules.</p>
<ol type="1">
<li>Navigate to the <a href="https://console.firebase.google.com/">Firebase Console</a>, and select 'Database' from the side panel.</li>
<li>Click on the 'Rules' tab.</li>
<li>Replace the rules text with the following code:</li>
</ol>
<div class="fragment"><div class="line">{</div>
<div class="line">  <span class="stringliteral">&quot;rules&quot;</span>: {</div>
<div class="line">    <span class="comment">// Bonus maps cannot be written to under normal circumstances.</span></div>
<div class="line">    <span class="stringliteral">&quot;BonusMaps&quot;</span>:  {</div>
<div class="line">      <span class="stringliteral">&quot;.read&quot;</span>: <span class="keyword">true</span>,</div>
<div class="line">      <span class="stringliteral">&quot;.write&quot;</span>: <span class="keyword">false</span></div>
<div class="line">    },</div>
<div class="line">    <span class="comment">// The DB_Users table contains all of the data for users.  It can only be read</span></div>
<div class="line">    <span class="comment">// or written to if your auth ID matches the key you are trying to access.</span></div>
<div class="line">    <span class="stringliteral">&quot;DB_Users&quot;</span>:  {</div>
<div class="line">      <span class="stringliteral">&quot;$uid&quot;</span>: {</div>
<div class="line">        <span class="stringliteral">&quot;.read&quot;</span>: <span class="stringliteral">&quot;(auth != null &amp;&amp; $uid == auth.uid) || $uid == &#39;XYZZY&#39;&quot;</span>,</div>
<div class="line">        <span class="stringliteral">&quot;.write&quot;</span>: <span class="stringliteral">&quot;(auth != null &amp;&amp; $uid == auth.uid) || $uid == &#39;XYZZY&#39;&quot;</span></div>
<div class="line">      }</div>
<div class="line">    },</div>
<div class="line">    <span class="comment">// Entries in the maplist can only be read if they are shared, or</span></div>
<div class="line">    <span class="comment">// they are being modified by their owner.</span></div>
<div class="line">    <span class="stringliteral">&quot;MapList&quot;</span>: {</div>
<div class="line">      <span class="stringliteral">&quot;$mapid&quot;</span>: {</div>
<div class="line">        <span class="stringliteral">&quot;.read&quot;</span>: <span class="stringliteral">&quot;data.child(&#39;isShared&#39;).val() == true || ((auth != null &amp;&amp; data.child(&#39;ownerId&#39;).val() == auth.uid) || data.child(&#39;ownerId&#39;).val() == &#39;XYZZY&#39;)&quot;</span>,</div>
<div class="line">        <span class="stringliteral">&quot;.write&quot;</span>: <span class="stringliteral">&quot;!data.exists() || (auth != null &amp;&amp; data.child(&#39;ownerId&#39;).val() == auth.uid) || data.child(&#39;ownerId&#39;).val() == &#39;XYZZY&#39;&quot;</span></div>
<div class="line">      }</div>
<div class="line">    },</div>
<div class="line">    <span class="comment">// High score tables for the offline maps.</span></div>
<div class="line">    <span class="stringliteral">&quot;OfflineMaps&quot;</span>: {</div>
<div class="line">      <span class="stringliteral">&quot;$mapid&quot;</span>: {</div>
<div class="line">        <span class="stringliteral">&quot;Times&quot;</span>: {</div>
<div class="line">          <span class="stringliteral">&quot;.read&quot;</span>: <span class="keyword">true</span>,</div>
<div class="line">          <span class="stringliteral">&quot;.write&quot;</span>: <span class="keyword">true</span>,</div>
<div class="line">          <span class="stringliteral">&quot;$rank&quot;</span>: {</div>
<div class="line">            <span class="stringliteral">&quot;.validate&quot;</span>: <span class="stringliteral">&quot;newData.child(&#39;name&#39;).isString() &amp;&amp; newData.child(&#39;time&#39;).isNumber() &amp;&amp; newData.child(&#39;name&#39;).val().length &lt; 100&quot;</span></div>
<div class="line">          }</div>
<div class="line">        }</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --><p>(MechaHamster uses the name 'XYZZY' to represent desktop users, since Firebase Authentication only functions on mobile devices.)</p>
<h4>Update Firebase url in the script</h4>
<p>MechaHamster can access Firebase Realtime Database in the Unity Editor. Set Database url to your project's database url using the SetEditorDatabaseUrl() function.</p>
<ol type="1">
<li>Open <code>\Assets\Hamster\Scripts\MainGame.cs</code> in the text editor.</li>
<li>Find the line with <code>SetEditorDatabaseUrl</code>. For instance, <div class="fragment"><div class="line"><span class="keywordtype">void</span> StartGame() {</div>
<div class="line">  ...</div>
<div class="line">  CommonData.app.SetEditorDatabaseUrl(<span class="stringliteral">&quot;https://hamster-demo.firebaseio.com/&quot;</span>);</div>
<div class="line">  ...</div>
<div class="line">}</div>
</div><!-- fragment --></li>
<li>Change the url to "https://YOUR-FIREBASE-APP.firebaseio.com/". "YOUR-FIREBASE-APP" is your project ID which you can find from the <a href="https://console.firebase.google.com/">Firebase Console</a> . You can also find the url in <code>google-services.json</code> (android) or <code>GoogleService-Info.plist</code> (iOS).</li>
<li>Save the script and rebuild with the Unity Editor.</li>
</ol>
<p>Currently this affects non-editor build as well.</p>
<p><br/>
 </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- Google Analytics -->
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-49880327-7', 'google.github.io');
ga('send', 'pageview');
</script>
</body>
</html>
